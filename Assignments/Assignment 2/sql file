CREATE OR REPLACE WAREHOUSE wh_assign2
  WAREHOUSE_SIZE = 'LARGE'        
  WAREHOUSE_TYPE = 'STANDARD'
  MIN_CLUSTER_COUNT = 1
  MAX_CLUSTER_COUNT = 3
  SCALING_POLICY = 'STANDARD'
  AUTO_SUSPEND = 60
  AUTO_RESUME = TRUE;


SHOW WAREHOUSES;
DESCRIBE WAREHOUSE wh_assign2;

use database MY_PRACTICE_DB;
use schema PUBLIC;

CREATE OR REPLACE TABLE big_events AS
SELECT
  SEQ4() AS id,
  DATEADD(second, UNIFORM(0, 1000, RANDOM()), CURRENT_TIMESTAMP()) AS event_ts,
  UNIFORM(1, 1000000, RANDOM())::NUMBER(12,0) AS user_id,
  MD5(TO_VARCHAR(SEQ4())) AS payload_hash
FROM TABLE(GENERATOR(ROWCOUNT => 10000000));


ALTER WAREHOUSE WH_ASSIGN2 SET WAREHOUSE_SIZE = 'XLARGE';


SELECT
  query_id,
  warehouse_name,
  total_elapsed_time/1000 AS runtime_seconds,
  start_time,
  query_text
FROM TABLE(INFORMATION_SCHEMA.QUERY_HISTORY_BY_USER(CURRENT_USER(), DATEADD('hour', -1, CURRENT_TIMESTAMP())))
WHERE query_text ILIKE '%BIG_EVENTS%'
ORDER BY start_time DESC;
